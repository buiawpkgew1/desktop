name: '代码扫描 - 操作'

on:
  push:
    branches: ['development']
  pull_request:
    branches: ['development']
  schedule:
    - cron: '0 19 * * 0'

jobs:
  CodeQL-Build:
    # CodeQL 在 ubuntu-latest、windows-latest 和 macos-latest 上运行
    runs-on: ubuntu-latest

    permissions:
      security-events: write

    steps:
      - name: 检出仓库
        uses: actions/checkout@v4

      # 初始化 CodeQL 工具以进行扫描。
      - name: 初始化 CodeQL
        uses: github/codeql-action/init@v2
        with:
          config-file: ./.github/codeql/codeql-config.yml

        # 通过取消注释以下内容并选择你的语言，覆盖语言选择
        # with:
        #   languages: go, javascript, csharp, python, cpp, java
      # Autobuild 尝试构建任何已编译语言（C/C++、C# 或 Java）。
      # 如果此步骤失败，则应删除它并手动运行构建（参见下文）。
      - name: 自动构建
        uses: github/codeql-action/autobuild@v2

      # ℹ️ 使用操作系统 shell 运行的命令行程序。
      # 📚 https://git.io/JvXDl

      # ✏️ 如果上面的 Autobuild 失败，请删除它并取消注释以下三行，并修改它们（或添加更多）以构建代码（如果项目使用已编译语言）

      #- run: |
      #     make bootstrap
      #     make release

      - name: 执行 CodeQL 分析
        uses: github/codeql-action/analyze@v2
